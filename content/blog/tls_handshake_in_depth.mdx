---
title: Wireshark - TLS 1.3 Handshake Examination 
description: Using Wireshark to examine and understand a TLS 1.3 handshake.
date: 2024-03-07
tags: ["networking", "wireshark", "tls"]
published: true
---

## The TLS Handshake 1.3

- Client hello
- Server hello, server extensions, certificate, cert. verify, and finished, all encrypted.
- from this point server can send application data if needed, although it's uncommon as it doesn't know what to send yet.
- client sends finished encrypted. Client can send application data at this point too after 1 round trip above.

This is a single round trip or 1RTT handshake. This reduces what's called the "time to first byte" (meaning round trips before the first byte of actual requested data is received) by a round trip.

This is important as with each request, there'll need to be DNS, TCP (three way handshake), TLS, and then the HTTP request.

The client can actually send encrypted application data (actual request data) in it's hello called "Early data". This has risks but can reduce TLS 1.3 to zero rounds trips to first byte. 0RTT.
Include information from GPT here that talks about the client encrpyting early data with the "expected" server public key, and if its calculation is wrong the early data is discared.

Talk about how cipher suite selection, with Wireshark code, is largely what saves round trip negotiations as per this link: https://blog.cloudflare.com/rfc-8446-aka-tls-1-3


Log Gemini steps here:

## Encrypred SNI

This is when client sends encrypted Server Name Indication in its hello. This lets a server that hosts multiple domains with different certificates to know which certificate to send to the client. This was done in 1.2 but not encrypted. No one can know from the wire which website is being requested.

continue from 8:20 in https://www.youtube.com/watch?v=JA0vaIb4158




